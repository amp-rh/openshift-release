#!/bin/bash
set -o nounset
set -o errexit
set -o pipefail

STORAGE_SCALE_NAMESPACE="${STORAGE_SCALE_NAMESPACE:-ibm-spectrum-scale}"

echo "üîç Verifying IBM Storage Scale Filesystem..."

# Verify filesystem exists and get status
oc get filesystem shared-filesystem -n ${STORAGE_SCALE_NAMESPACE}

# Check filesystem conditions
echo "Filesystem conditions:"
oc get filesystem shared-filesystem -n ${STORAGE_SCALE_NAMESPACE} \
  -o jsonpath='{range .status.conditions[*]}  {.type}: {.status} - {.message}{"\n"}{end}'

# Verify StorageClass was created
echo ""
if oc get storageclass | grep -q spectrum; then
  echo "‚úÖ StorageClass created:"
  oc get storageclass | grep spectrum
else
  echo "‚ö†Ô∏è  StorageClass not found yet (may still be creating)"
fi

echo ""
echo "‚úÖ Filesystem verification completed"
